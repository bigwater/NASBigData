"""
KMP_BLOCK_TIME=0


horovodrun -np 4 python -m deephyper.benchmark.nas.covertype.train
"""

from nas_big_data.cifar10.problem_ae import Problem
from deephyper.search.nas.model.run.horovod import run

config = Problem.space

config["hyperparameters"]["num_epochs"] = 20
config["hyperparameters"]["learning_rate"] = 0.001
config["hyperparameters"]["batch_size"] = 128
config["hyperparameters"]["verbose"] = 1


config["arch_seq"] = [
    0.39886367990343485,
    0.055741542273140765,
    0.9034737346387091,
    0.23088655167386463,
    0.46998686432536063,
    0.2935663212377132,
    0.37293610659166165,
    0.8442681351383972,
    0.18920794024474685,
    0.1126126425835452,
    0.703767196395961,
    0.5696559980096368,
    0.8009000180585434,
    0.3756030993500967,
    0.9780324885155195,
    0.8543660124588658,
    0.6071974877150892,
    0.14536134976265824,
    0.33924435647434414,
    0.8815155355452716,
    0.5217879597332606,
    0.3948686799323069,
    0.7798070037431973,
    0.13741207973754754,
    0.12377874702631553,
    0.9653275773188447,
    0.2920908820216428,
    0.7458692316883514,
    0.9497512271969799,
    0.07749102638690142,
    0.2550872760978422,
    0.6272644215912849,
]

run(config)
